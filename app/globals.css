@tailwind base;
@tailwind components;
@tailwind utilities;

:root { color-scheme: light; }
:root {
  /* Base (light UI) - warm beige */
  --bg: #F7F3EE;       /* page background */
  --surface: #FFFFFF;  /* cards */
  --surface-2: #FCFAF7;/* subtle surfaces */
  --text: #0B0B0B;
  --text-muted: #5B6271;
  --border: #E8E1D8;   /* warm border */
  --shadow: rgba(15, 23, 42, 0.06);

  /* Brand & primary actions */
  --brand-600: #F97316; /* primary buttons */
  --brand-500: #FB923C; /* hover */
  --brand-50:  #FFF7ED; /* subtle bg */

  /* Chat emphasis */
  --chat-600: #2563EB;
  --chat-500: #3B82F6;
  --chat-50:  #EFF6FF;

  /* Status / feedback */
  --success-600: #10B981;
  --warning-600: #F59E0B;
  --danger-600:  #EF4444;
  --info-600:    #0EA5E9;

  /* Gradients */
  --grad-primary: linear-gradient(180deg, #FF8A4C 0%, #F97316 100%);
  --grad-chat:    linear-gradient(180deg, #60A5FA 0%, #2563EB 100%);

  /* Aliases for existing utility variables */
  --page-bg: var(--bg);
  --card: var(--surface);
  --ink: var(--text);
  --ink-strong: var(--text);
  --primary: var(--brand-600);
  --primary-soft: var(--brand-50);
  --accent: var(--chat-600);
  --accent-soft: var(--chat-50);
  --warn: var(--warning-600);
  --warn-soft: #FEF3C7; /* soft yellow */
  --danger: var(--danger-600);
  --danger-soft: #FFE4E6; /* soft red */

  /* Contract preview theme (light) */
  --contract-preview-bg: #FFFFFF;
  --contract-preview-fg: #111827;
  --contract-preview-border: #E5E7EB;
  --contract-preview-header-fg: #334155;
  --contract-preview-font: "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  --contract-preview-size: 20px;

  /* Chat panel theme (light-friendly) */
  /* Soft beige to blend with dashboard; can be overridden via Settings */
  --chat-bg: #F3EEE7;
  --chat-bot-bg: #1E3A8A; /* keep bot bubble blue */
}

/* Chat bubbles (iMessage-like) */
.bubble-bot {
  position: relative;
  background: var(--chat-bot-bg, #1E3A8A);
  color: #ffffff; /* bright white text */
  border: none; /* remove grey-ish border */
  border-radius: 1.25rem 1.25rem 1.25rem 0.6rem; /* tail on left */
  box-shadow: 0 1px 0 rgba(0,0,0,0.08), 0 8px 18px rgba(2,6,23,0.22);
}
.bubble-bot::after {
  content: '';
  position: absolute;
  left: -6px;
  bottom: 8px;
  width: 14px;
  height: 14px;
  background: inherit; /* same as bubble */
  transform: rotate(45deg);
  border-bottom-left-radius: 6px;
  filter: drop-shadow(0 1px 0 rgba(0,0,0,0.08));
}

.bubble-user {
  position: relative;
  background: #ffffff;
  color: #0F172A;
  border: 1px solid rgba(0,0,0,0.05);
  border-radius: 1.25rem 1.25rem 0.6rem 1.25rem; /* tail on right */
}
.bubble-user::after {
  content: '';
  position: absolute;
  right: -6px;
  bottom: 8px;
  width: 14px;
  height: 14px;
  background: inherit;
  transform: rotate(-45deg);
  border-bottom-right-radius: 6px;
  box-shadow: 0 1px 0 rgba(0,0,0,0.04);
}
html, body { height: 100%; }
body {
  background: var(--bg);
  color: var(--ink);
  font-family: "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
}
html { scroll-behavior: smooth; }
/* Prevent horizontal drift on small screens by default */
@media (max-width: 767.98px) {
  html, body { overflow-x: hidden; }
}
/* Utilities to wrap long words/URLs when needed (do not apply globally) */
.break-words { overflow-wrap: break-word; word-break: break-word; }
.break-anywhere { overflow-wrap: anywhere; word-break: break-word; }
/* Make media responsive by default */
img, video, iframe, embed, object { max-width: 100%; height: auto; }
/* iOS momentum scrolling on scrollable areas */
.overflow-auto, .overflow-y-auto, .overflow-x-auto { -webkit-overflow-scrolling: touch; }
/* Hide scrollbars when explicitly requested */
.no-scrollbar { /* intentionally preserved for opt-out; do not apply to client lists */ }
.visible-scrollbar { scrollbar-width: auto; }
.visible-scrollbar::-webkit-scrollbar { height: 12px; width: 10px; }
.visible-scrollbar::-webkit-scrollbar-thumb { background: rgba(15,23,42,0.12); border-radius: 8px; }
.visible-scrollbar::-webkit-scrollbar-track { background: transparent; }
/* ensure base text color propagates into headings/anchors unless explicitly overridden */
h1, h2, h3, h4, h5, h6, p, a, li, span, label, small, strong, em { color: inherit; }

/* Normalize link appearance (avoid default underlines/purple visited) */
a { color: inherit; text-decoration: none; }
a:hover { text-decoration: none; }
a:visited { color: inherit; }

/* CSS variable backed utility-like classes */
.text-ink { color: var(--ink); }
.text-muted { color: var(--text-muted); }
.bg-surface { background-color: var(--surface); }
.bg-card { background-color: var(--card); }
.text-primary { color: var(--primary); }
.bg-primary { background-color: var(--primary); }
.bg-primarySoft { background-color: var(--primary-soft); }
.text-accent { color: var(--accent); }
.bg-accent { background-color: var(--accent); }
.bg-accentSoft { background-color: var(--accent-soft); }
.text-warn { color: var(--warn); }
.bg-warn { background-color: var(--warn); }
.bg-warnSoft { background-color: var(--warn-soft); }
.text-danger { color: var(--danger); }
.bg-danger { background-color: var(--danger); }
.bg-dangerSoft { background-color: var(--danger-soft); }

/* New token-aligned helpers */
.border-default { border-color: var(--border); }
.shadow-soft { box-shadow: 0 10px 24px var(--shadow); }
.bg-page { background-color: var(--bg); }
.bg-grad-primary { background: var(--grad-primary); }
.bg-grad-chat { background: var(--grad-chat); }

/* Pastel tiles (initial definitions; overridden later for stronger specificity) */
.tile-followup { background: #FFF7ED; color: #7C2D12; border-color: var(--border); }
.tile-amend   { background: #ECFDF5; color: #064E3B; border-color: var(--border); }
.tile-create  { background: #EEF2FF; color: #312E81; border-color: var(--border); }
.tile-reminder{ background: #F5F3FF; color: #4C1D95; border-color: var(--border); }

/* Dashboard tiles per spec */
.tile { border-width: 1px; border-style: solid; border-radius: 1rem; }
/* Soft cards for light theme */
.card-soft { position: relative; overflow: hidden; border-radius: 1rem; border: 1px solid var(--border); background: var(--surface); box-shadow: 0 10px 24px var(--shadow); }

/* Neutral tiles (light theme) */
.tile-soft {
  background: var(--surface);
  color: var(--ink-strong);
  border: 1px solid var(--border);
  border-radius: 1rem;
  transition: background-color 200ms ease, box-shadow 200ms ease, transform 200ms ease;
}
.tile-soft:hover { background: var(--surface-2); box-shadow: 0 8px 26px var(--shadow); }
.text-subtle { color: var(--text-muted); }

/* Accent helpers for quick scanning */
.accent-green { color: #16A34A; }
.accent-teal { color: #0D9488; }
.accent-amber { color: #D97706; }
.accent-blue { color: var(--accent); }
.accent-purple { color: #9333EA; }
.status-open { color: #22C55E; }
.status-closed { color: #DC2626; }

/* Tile secondary text colors */
.tile-sec-active { color: #1E3A8A; }
.tile-sec-leads { color: #0F766E; }
.tile-sec-closings { color: #92400E; }
.tile-sec-total { color: #7E22CE; }

/* Icon chip backgrounds and icon accent colors */
.icon-chip-dark { background: #F1F5F9; }
.icon-chip-yellow { background: #FEF3C7; }
.icon-accent-active { color: #2563EB; }
.icon-accent-leads { color: #0D9488; }
.icon-accent-closings { color: #CA8A04; }
.icon-accent-total { color: #DC2626; }

/* Border helpers tied to theme variables */
.border-primary { border-color: var(--primary) !important; }
.border-accent { border-color: var(--accent) !important; }
.border-warn { border-color: var(--warn) !important; }
.border-danger { border-color: var(--danger) !important; }

/* Ensure space for fixed bottom nav on pages */
.has-bottom-nav { padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 88px); }

/* Inputs and form elements */
input::placeholder, textarea::placeholder { color: #94A3B8; }

/* Apple Typography utilities */
.sf-display { font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
.sf-text { font-family: "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
.h1 { font-size: 5.333rem; /* ~37.3px (28pt) */ line-height: 1.15; font-weight: 600; }
.h2 { font-size: 1.833rem; /* ~29.3px (22pt) */ line-height: 1.2; font-weight: 600; }
.h3 { font-size: 1.5rem;   /* 24px (18pt) */    line-height: 1.25; font-weight: 600; }
.lh-card-tight { line-height: 1.35; }
.lh-section-loose { line-height: 1.55; }

/* Tints for icon chips */
.tint-primary { background: rgba(0,122,255,0.12); color: var(--primary); }
.tint-accent { background: rgba(52,199,89,0.12); color: var(--accent); }
.tint-warn { background: rgba(255,215,102,0.25); color: #9A7B00; }
.tint-danger { background: rgba(255,107,107,0.15); color: var(--danger); }
/* More specific tints for dashboard tiles */
.tint-amber { background: #FDF1E7; color: #C2410C; }
.tint-green { background: #E8FFF5; color: #0C8A5B; }
.tint-purple { background: #ECEBFF; color: #4C1D95; }
.tint-blue { background: #ECF2FF; color: #1E40AF; }

/* Tile color overrides with stronger specificity to beat .tile-soft background */
.tile.tile-followup { background: #EADBC8; color: #5C3A1E; border-color: var(--border); }
.tile.tile-amend   { background: #D8F3EA; color: #0F5132; border-color: var(--border); }
.tile.tile-create  { background: #E0E6FF; color: #233876; border-color: var(--border); }
.tile.tile-reminder{ background: #DED6F7; color: #3F2D7E; border-color: var(--border); }

.panel-glass {
  position: relative;
  overflow: hidden;
  background: rgba(255, 255, 255, 0.8);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border);
  border-radius: 1rem; /* ~16px */
  box-shadow: 0 10px 30px var(--shadow);
}
.panel-glass:hover { background: rgba(255, 255, 255, 0.9); }
.panel-elevated { box-shadow: 0 16px 40px var(--shadow); }
.rounded-apple { border-radius: 1.125rem; }

/* iOS-style “liquid” highlight layers */
.glass.glass-liquid::before,
.glass.glass-liquid::after {
  content: '';
  position: absolute;
  inset: -10%;
  pointer-events: none;
}
.glass.glass-liquid::before {
  /* soft internal glow and highlight blobs */
  background:
    radial-gradient(40% 60% at 20% 0%, rgba(0,0,0,0.06) 0%, rgba(0,0,0,0.0) 60%),
    radial-gradient(30% 40% at 85% 10%, rgba(37,99,235,0.08) 0%, rgba(255,255,255,0.0) 60%),
    radial-gradient(60% 60% at 50% 120%, rgba(236,72,153,0.08) 0%, rgba(0,0,0,0.0) 60%);
  mix-blend-mode: screen;
}
.glass.glass-liquid::after {
  /* subtle liquid shimmer */
  background: radial-gradient(120% 80% at 10% 0%, rgba(0,0,0,0.06) 0%, rgba(255,255,255,0.0) 60%);
  transform: translate3d(0,0,0);
  animation: glass-shift 24s ease-in-out infinite;
}

@keyframes glass-shift {
  0% { transform: translate3d(0%, 0%, 0) scale(1); }
  50% { transform: translate3d(2%, -2%, 0) scale(1.02); }
  100% { transform: translate3d(0%, 0%, 0) scale(1); }
}

.neon { text-shadow: none; }

/* Pill styles for statuses */
.pill { display: inline-flex; align-items: center; gap: 0.375rem; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600; }
.pill-primary { background: var(--primary-soft); color: var(--primary); }
.pill-warn { background: var(--warn-soft); color: #9A7B00; }
.pill-success { background: var(--accent-soft); color: var(--accent); }
.pill-danger { background: var(--danger-soft); color: var(--danger); }

/* Floating circular glass button */
.btn-glass-circle {
  display: inline-flex; align-items: center; justify-content: center;
  width: 56px; height: 56px; border-radius: 9999px;
  background: rgba(15,23,42,0.45);
  border: 1px solid rgba(255,255,255,0.18);
  -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
  box-shadow: 0 10px 25px rgba(37,99,235,0.20), 0 2px 8px rgba(236,72,153,0.16);
}
.btn-glass-circle:hover { background: rgba(15,23,42,0.55); -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px); box-shadow: 0 12px 28px rgba(37,99,235,0.28), 0 3px 10px rgba(236,72,153,0.20); }

@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
}

/* Vibrant, neon-friendly cards for AI sections */
.ai-card { border-radius: 1.125rem; border: 1px solid var(--border); background: var(--surface); transition: background-color .2s ease, box-shadow .2s ease, transform .2s ease; }
.ai-card:hover { box-shadow: 0 10px 24px var(--shadow); transform: translateY(-1px); }
.ai-card-blue { background: var(--accent-soft); color: var(--accent); }
.ai-card-amber { background: #FFF7ED; color: #9A3412; }
.ai-card-dark-blue { background: var(--accent); border-color: var(--accent); color: #ffffff; }
.ai-chip { width: 40px; height: 40px; display: grid; place-items: center; border-radius: 0.5rem; }
.ai-chip-blue { background: rgba(37,99,235,0.18); color: #93C5FD; }
.ai-chip-amber { background: rgba(250,204,21,0.20); color: #FDE68A; }
.heading-blue { color: #BFDBFE; }
.heading-amber { color: #FDE68A; }
.text-pop { color: #E5E7EB; }
.content-box-light { background: rgba(15,23,42,0.55); border: 1px solid rgba(255,255,255,0.10); color: #E5E7EB; }

/* Neon inputs & buttons */
.input-neon {
  background: var(--surface);
  color: var(--ink);
  border: 1px solid var(--border);
  border-radius: 0.75rem;
  outline: none;
  transition: box-shadow .2s ease, border-color .2s ease;
}
.input-neon:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(37,99,235,0.20);
}
.btn-neon {
  background: var(--grad-primary);
  color: white;
  border-radius: 0.875rem;
  padding: 0.75rem 1rem;
  font-weight: 600;
  box-shadow: 0 8px 24px var(--shadow);
  transition: transform .12s ease, box-shadow .2s ease, opacity .2s ease;
}
.btn-neon:hover { box-shadow: 0 10px 28px var(--shadow); }
.btn-neon:active { transform: translateY(1px); }

/* Badges for statuses */
.badge { display: inline-flex; align-items: center; gap: .375rem; padding: .25rem .625rem; border-radius: 9999px; font-weight: 700; font-size: .75rem; }
.badge-blue { background: #DBEAFE; color: #1E40AF; }
.badge-green { background: #DCFCE7; color: #166534; }
.badge-yellow { background: #FEF9C3; color: #854D0E; }
.badge-red { background: #FFE4E6; color: #9F1239; }

/* Alternating list rows */
.row-pill { border-radius: 9999px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.10); }
.row-pill:nth-child(odd) { background: rgba(255,255,255,0.08); }
.row-pill:hover { box-shadow: 0 0 0 1px rgba(37,99,235,0.45) inset, 0 6px 18px rgba(37,99,235,0.20); }

/* Contract preview styles (uses variables above) */
.contract-preview {
  background: var(--contract-preview-bg);
  color: var(--contract-preview-fg);
  border: 1px solid var(--contract-preview-border);
}
.contract-preview .contract-preview-title {
  color: var(--contract-preview-header-fg);
}
.contract-preview pre {
  font-family: var(--contract-preview-font);
  font-size: var(--contract-preview-size);
  line-height: 1.6;
}

/* Responsive layout helpers and mobile-first adjustments */
@media (max-width: 1023.98px) {
  /* Slightly tighter gutters on tablet */
  .container, .max-w-6xl { padding-left: 1rem; padding-right: 1rem; }
}
@media (max-width: 767.98px) {
  /* Single-column bias and full-width form controls */
  form button, form input, form select, form textarea { width: 100%; }
  /* Comfortable touch targets */
  button, .btn, .btn-neon, input[type="button"], input[type="submit"], input[type="reset"], select, textarea, input[type="text"], input[type="email"], input[type="tel"], input[type="password"] {
    min-height: 44px;
  }
  /* Tables become horizontally scrollable instead of overflowing */
  table { display: block; width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
  thead, tbody, tr { display: table; width: 100%; table-layout: fixed; }
}

/* Mobile Chat Support */
@supports (height: 100dvh) {
  .mobile-chat-container {
    height: 100dvh;
    max-height: 100dvh;
  }
}

@supports not (height: 100dvh) {
  .mobile-chat-container {
    height: 100vh;
    max-height: 100vh;
  }
}

:root {
  --input-bar-height: 80px;
  --chat-gutter: 16px;
  --mobile-keyboard-height: 0px;
}

/* Support for dvh units fallback */
@supports not (height: 100dvh) {
  .mobile-chat-container {
    height: 100vh;
  }
}

@supports (height: 100dvh) {
  .mobile-chat-container {
    height: 100dvh;
  }
}

/* Email formatting styles */
.email-preview {
  font-family: system-ui, -apple-system, 'Segoe UI', sans-serif;
  line-height: 1.6;
  color: #374151;
}

.email-preview p {
  margin: 0 0 16px 0 !important;
  font-size: 14px;
  line-height: 1.6;
}

.email-preview p:last-child {
  margin-bottom: 0 !important;
}

/* Professional email content styling */
.email-content {
  font-family: system-ui, -apple-system, 'Segoe UI', sans-serif;
  max-width: 600px;
  line-height: 1.6;
  color: #333;
}

.email-content p {
  margin: 0 0 16px 0;
  font-size: 16px;
  line-height: 1.6;
}

.email-content p:last-child {
  margin-bottom: 0;
}
